Revision: 0be5cc1f1a54c9823754556bfbbf0a4a50924e52
Patch-set: 3
File: benchmark/micro-native/micro_native_locals.cc

26
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_db5d0c95
Bytes: 86
Pull these macros out into a common header? micro-native.h or common.h should suffice.

26
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_db5d0c95
UUID: c1d3dce9_6624b67b
Bytes: 4
Done

30:39-30:42
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_3b1fd0d2
Bytes: 167
Too few, use 1000000 which is the same value as in the java file.

Also add an assert that it's the same thing as in the Java file.

NativeBenchmarkBase#EXERCISE_COUNT

30:39-30:42
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_3b1fd0d2
UUID: c1d3dce9_4633b2c2
Bytes: 56
This is complicated right now, as tables would overflow.

36
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_bb0a0092
Bytes: 195
I think it's missing one where it newlocalrefs in a loop then deletelocalrefs in a loop (I guess in reverse).

That's the more common case when using a bunch of "ScopedLocalRef" at the same scope

36
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_bb0a0092
UUID: c1d3dce9_460172b2
Bytes: 4
Done

52:12-52:41
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_3b4d10df
Bytes: 390
Naming wise I'd like to see it be called LocalRefs

If you are planning on adding global/weak refs to this file as well (and it certainly makes sense), then rename to IndirectRefs for most generality (and use the same prefix as the name of the java class containing the natives).

The java *benchmark* names should probably be something like UpcallRefLocalAdd, UpcallRefLocalAddRemove, etc.

52:12-52:41
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_3b4d10df
UUID: c1d3dce9_a6bdbebb
Bytes: 88
Push and Pop only make sense for local references. I'm trying to figure out a good name.

73
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_dbd26cbb
Bytes: 230
Consider a few more cases with Push/Pop as it simulates the cost of multiple JNI transitions.

Could probably simple reuse some of the other functions (e.g. by calling a callback there which pushes/pops) by restructuring it a bit.

75:42-75:43
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_3bbb507b
Bytes: 17
nit: make varname

75:42-75:43
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_3bbb507b
UUID: c1d3dce9_86c51a4c
Bytes: 4
Done

88
Fri Oct 21 20:08:16 2016 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3c913fcf_1b685433
Bytes: 30
Put this into a common header?

88
Mon Oct 24 22:12:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3c913fcf_1b685433
UUID: c1d3dce9_46cf3268
Bytes: 94
Done. Had to rename, so that there's no confusion with the same function from libnativehelper.

