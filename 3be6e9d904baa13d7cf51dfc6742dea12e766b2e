Revision: 3be6e9d904baa13d7cf51dfc6742dea12e766b2e
Patch-set: 1
File: cmdline/cmdline_types.h

90:4-169:32
Thu Feb 05 17:48:13 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: bcd07810_e111c67b
Bytes: 120
Is there a reason to touch all this? It seems like a semantically equivalent transformation, and a reason would be nice.

90:4-169:32
Thu Feb 05 18:00:05 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: bcd07810_e111c67b
UUID: 9c073452_365200ae
Bytes: 225
I changed jdwp_options to a pointer in ParseOption because we modify it and IIRC we agreed on using pointer than reference in that case, right?
For the Parse method, you're right. It's mainly to transform into a foreach loop.

90:4-169:32
Thu Feb 05 18:48:58 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 9c073452_365200ae
UUID: 1ce984cf_5c8dfd16
Bytes: 518
BTW, stylistically the "most consistent" thing would be to have this function return Result just like all the other type-parsers. Also in that case you wouldn't need to change it to use a pointer

  error_stream << error_message +
  return false
     becomes:
  return Result::Failure(error_message)
  
  return true 
     becomes:
  return Result::Success(jdwp_options)

The reason it was using a reference is because I refactored it from the jdwp header file with minimal changes (error_stream instead of LOG(error))

File: runtime/runtime.cc

231
Thu Feb 05 18:02:38 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: bcd07810_0184ea1e
Bytes: 102
Minor nit: redundant check//you could also use unique_ptr to avoid changing the constructor/destructor

807
Thu Feb 05 18:02:38 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: dccb6c64_2289eebd
Bytes: 72
Argh, sorry about this, completely forgot that jdwp_options was a global

809:4-809:51
Thu Feb 05 17:40:25 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 5c1a1cb5_29aaa96e
Bytes: 116
This is to avoid including jdwp/jdwp.h into runtime.h file (which is included almost everywhere already).

Opinions?

809:4-809:51
Thu Feb 05 17:48:13 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 5c1a1cb5_29aaa96e
UUID: bcd07810_a107be3e
Bytes: 310
You could use a unique_ptr (it works as long as constructor and destructor of Runtime are in the .cc file, which they are). Else I think it's fine.

Alternatively, looking at the debugger, we only allow one per process, it seems, as the interface is static. So you could also store it there as a static member?

809:4-809:51
Thu Feb 05 18:00:05 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: bcd07810_a107be3e
UUID: 5c1a1cb5_c972f579
Bytes: 204
OK, I'll try the unique_ptr. 

I agree about Dbg class, there's only one. That's in my todo list of a more global refactoring. That could simplify the access to JDWP options when starting the JDWP thread.

