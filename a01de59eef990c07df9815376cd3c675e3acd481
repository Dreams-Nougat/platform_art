Revision: a01de59eef990c07df9815376cd3c675e3acd481
Patch-set: 6
File: runtime/handle.h

64:21-64:27
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_dddf5b50
Bytes: 22
Why not operator bool?

64
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_dddf5b50
UUID: 4d556338_e07b988f
Bytes: 31
That's not the way we do thing.

File: runtime/mirror/array.h

217:14-217:34
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_1d4ef339
Bytes: 116
Restrict annotations? Libc memcpy has them; without them, the compiler has to make pessimistic aliasing assumptions.

217
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_1d4ef339
UUID: 8d159bc1_be744d77
Bytes: 52
Won't do anything here. We are just passing it down.

221:6-221:21
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_3d7bf769
Bytes: 89
Why the lock annotation? It's just memcpy. Isn't it up to the caller to use it correctly?

221
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_3d7bf769
UUID: 4d556338_e0d8b882
Bytes: 69
We are hitting java heap memory so we need to have the mutator_lock_.

File: runtime/modifiers.h

70:84-70:88
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_fd369fa2
Bytes: 3
its

70
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_fd369fa2
UUID: 8d159bc1_5e8c3154
Bytes: 4
Done

File: runtime/openjdkjvmti/ti_redefine.cc

52:3-52:58
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_5dd34b1a
Bytes: 86
Why do we need a whole page and a whole VMA? What if we redefine thousands of classes?

52
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_5dd34b1a
UUID: 4d556338_00e32c1a
Bytes: 233
Currently our art::DexFile requires that the backing memory be in an MMAP. This is both for security reasons (PROT_READ) and since dex files are almost always file-backed. We could change this in the future but it not a priority ATM.

69:2-69:39
Wed Nov 30 21:50:22 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 8dd83b0a_31b11096
Bytes: 168
Sorry, should have been clearer. Please add a comment on why you need to map it read only.

(The comment you added is  a repetition of the code, which isn't necessary).

69
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 8dd83b0a_31b11096
UUID: 4d556338_f7e24014
Bytes: 157
I mean the real reason is why not. There isn't any need to modify this any more so might as well.

We only need it PROT_WRITE so we can copy stuff in.

Done.

190
Thu Dec 01 00:57:52 2016 +0000
Author: Daniel Colascione <1130394@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4d556338_00a16c78
Bytes: 136
I don't think this functionality should depend on ClassLoader internals. Applications can (and do!) use whatever classloaders they want.

190
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d556338_00a16c78
UUID: 8d159bc1_7e3db57e
Bytes: 118
We need to know a bit about classloaders to implement this. These restrictions may be lifted or relaxed in the future.

239:54-239:59
Wed Nov 30 21:50:22 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 8dd83b0a_d1b52482
Bytes: 45
second, right? (second element, but index 1).

239
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 8dd83b0a_d1b52482
UUID: 4d556338_f76520f6
Bytes: 107
no first. Index 0. See next line.

This array has the OatDex as the first element the rest are all DexFiles

File: runtime/openjdkjvmti/ti_redefine.h

71:65-71:69
Wed Nov 30 21:50:22 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 8dd83b0a_11ac0c3b
Bytes: 3
its

71
Sat Dec 03 01:34:29 2016 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 8dd83b0a_11ac0c3b
UUID: 8d159bc1_9e1aa954
Bytes: 4
Done

