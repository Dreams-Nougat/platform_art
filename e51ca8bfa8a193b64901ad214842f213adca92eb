Revision: e51ca8bfa8a193b64901ad214842f213adca92eb
Patch-set: 7
File: runtime/jit/jit_code_cache.cc

341:32-341:44
Tue Nov 29 21:21:45 2016 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: ade97f6b_bd7058fd
Bytes: 124
The class loader keeps the class live, you can probably just call IsMarked on the class and never do it on the class loader.

341:32-341:44
Tue Nov 29 21:26:14 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: ade97f6b_bd7058fd
UUID: 4d90030a_82c99c6a
Bytes: 178
But IsMarked will return null for newly allocated classes on CMS. So the code here will not know if the null is because the class is dead, or if it's just been allocated.

Right?

341:32-341:44
Tue Nov 29 21:31:12 2016 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d90030a_82c99c6a
UUID: ade97f6b_5d2eecbc
Bytes: 172
Hmm true, I think WaitUntilInlineCacheAccessible is not called before calling AddInvokeInfo. Are there any issues from newly allocated class loaders maybe not being marked?

341:32-341:44
Tue Nov 29 21:40:24 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: ade97f6b_5d2eecbc
UUID: 4d90030a_e2b748d8
Bytes: 304
Not calling WaitUntilInlineCacheAccessible before calling AddInvokeInfo is fine, as the only think AddInvokeInfo is doing is storing a class that is known live.

No there cannot be any issue with newly allocated class loaders, as they cannot be added to the list of weak root class loaders at this point.

