Revision: f55259338b60d74fd29919362f13730c89f2a770
Patch-set: 1
File: compiler/dex/verification_results.cc

51:2-51:32
Fri Nov 25 16:33:55 2016 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b04b9845_15511680
Bytes: 181
Memory leak? (Why did you remove the "TODO: Investigate why are we doing the work again for this method and try to avoid it"? Did you investigate and find out it no longer applies?)

51:2-51:32
Mon Nov 28 09:45:49 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b04b9845_15511680
UUID: 4d90030a_1fdba30b
Bytes: 323
When you say memory leak, are you referring to the previous race?

I think the race was due to JIT at the time. But we removed the use of VerifiedMethod from the JIT.

I can add a:
if (kIsDebugBuild) {
  // Lock
  // Check entry is null
  // update
  // unlock
}

if we want to be extra sure for AOT. Would you prefer that?

51:2-51:32
Mon Nov 28 10:26:02 2016 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d90030a_1fdba30b
UUID: b04b9845_155bd672
Bytes: 88
That comment comes from https://android-review.googlesource.com/80012 , long before JIT.

51:2-51:32
Mon Nov 28 10:31:49 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b04b9845_155bd672
UUID: 4d90030a_7ffc2f4f
Bytes: 90
Thanks for the history.

I didn't hit it. So do you prefer having the check in debug mode?

51:2-51:32
Mon Nov 28 11:30:20 2016 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4d90030a_7ffc2f4f
UUID: 705120f4_93befe07
Bytes: 112
I want to handle it gracefully even in release mode. If you want to get rid of that, at least run a scanner job.

