Revision: ffa0a4395dbd7db9db78536a22199c80f55c0a23
Patch-set: 1
File: /COMMIT_MSG

9:0-11:48
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 17479f3f_2cac1305
Bytes: 214
Not a valid English sentence. Maybe: "During compilation, a java.lang.InternalError is used to indicate that class initialization failed and the enclosing transaction should be aborted and the changes rolled back."

9:0-11:48
Wed Feb 04 09:58:54 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 17479f3f_2cac1305
UUID: 7c928013_9f11f37c
Bytes: 4
Done

12:19-12:27
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 17479f3f_8c68a710
Bytes: 61
Be more specific (what code). Maybe: "class initializer code"

12:19-12:27
Wed Feb 04 09:58:54 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 17479f3f_8c68a710
UUID: 1c1ee459_9a55ad08
Bytes: 4
Done

13:48-14:54
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 17479f3f_cc72affe
Bytes: 51
We don't forget. "This hides" or something like it.

13:48-14:54
Wed Feb 04 09:58:54 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 17479f3f_cc72affe
UUID: dc836cc3_02cd8a64
Bytes: 4
Done

File: runtime/class_linker.cc

4224:6-4225:42
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 17479f3f_cfd0e154
Bytes: 108
Maybe we should consider a LOG(WARNING) for this case. I really hate that there's code out there doing this.

4224:6-4225:42
Wed Feb 04 09:58:54 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 17479f3f_cfd0e154
UUID: 7c928013_bfaab795
Bytes: 280
I found it more consistent to leave the class initializer with a pending exception if the transaction was aborted. However it's not mandatory to do that. We could move that check up to the compiler driver when we return from the class initialization.

Would you prefer doing that?

4224:6-4225:42
Wed Feb 04 15:49:30 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 7c928013_bfaab795
UUID: bc7158c9_393c8ff0
Bytes: 123
How would you detect this case in the compiler driver? I think the LOG would have to be here, but it was just a suggestion.

4224:6-4225:42
Wed Feb 04 16:24:16 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: bc7158c9_393c8ff0
UUID: 9c665411_1882e5e1
Bytes: 115
With the same check: Runtime::Current()->IsTransactionAborted(). I prefer keeping that here for consistency though.

File: runtime/transaction.h

46:2-46:41
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b737b3c2_294b2dec
Bytes: 80
bdc, you're the transaction (-al memory) professional. Is this the right naming?

91:2-91:17
Tue Feb 03 18:42:40 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b737b3c2_696e0566
Bytes: 32
I like that naming, it's better.

91:2-91:17
Wed Feb 04 09:58:54 2015 +0000
Author: Sebastien Hertz <1029223@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b737b3c2_696e0566
UUID: 1c1ee459_9aaa4d96
Bytes: 59
Yes, I found it ambiguous when getting back into that code.

